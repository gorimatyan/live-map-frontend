import { MarkerAnnotationData } from "@/utils/type/map/MapAnnotationType"

/**
 * ğŸ”„ ãƒãƒƒãƒ—ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ Twitter API ã«æ¸¡ã™ãŸã‚ã®ã‚¯ã‚¨ãƒªã«å¤‰æ›ã™ã‚‹é–¢æ•°
 *
 * @param {MapAnnotationData} data - é¸æŠã•ã‚ŒãŸãƒãƒƒãƒ—ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿
 * @returns {string} å¤‰æ›å¾Œã®æ¤œç´¢ã‚¯ã‚¨ãƒªï¼ˆä¾‹: `"ãƒãƒƒã‚«ã‚½ãƒ³,ç¦å²¡å¸‚|ãƒãƒƒã‚«ã‚½ãƒ³,ä¸­å¤®åŒº|ãƒãƒƒã‚«ã‚½ãƒ³,å¤©ç¥"`ï¼‰
 */
export const formatTweetQueryParams = (data: MarkerAnnotationData): string => {
  // ğŸ“Œ ã‚¨ãƒªã‚¢æƒ…å ±ã‚’éƒ½é“åºœçœŒãƒ»å¸‚åŒºç”ºæ‘ãƒ¬ãƒ™ãƒ«ã¾ã§ã«ã™ã‚‹ï¼ˆä¸ç›®ãƒ»ç•ªåœ°ã¯é™¤å¤–ï¼‰
  let areaParts = data.area
    .replace(/[0-9ï¼-ï¼™\-âˆ’ä¸ç›®ç•ªåœ°å·]/g, "") // ã€Œ1ä¸ç›®10âˆ’20ã€ãªã©ã®è©³ç´°ä½æ‰€ã‚’å‰Šé™¤
    .replace(/å¸‚|åŒº|ç”º|æ‘|çœŒ|åºœ|é“|éƒ½/g, " ") // ã€Œå¸‚ãƒ»åŒºãƒ»ç”ºãƒ»æ‘ãƒ»çœŒã€ã‚’ã‚¹ãƒšãƒ¼ã‚¹ã«å¤‰æ›
    .split(/\s+/) // ç©ºç™½ã§åˆ†å‰²
    .map((part) => part.trim()) // å‰å¾Œã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»
    .filter((part) => part.length > 1) // 1æ–‡å­—ã®å˜èªã¯å‰Šé™¤ï¼ˆä¾‹: "åŒº"ï¼‰

  if (areaParts.length === 0) {
    return data.category // ã‚¨ãƒªã‚¢æƒ…å ±ãŒãªã„å ´åˆã¯ã‚«ãƒ†ã‚´ãƒªã®ã¿
  }

  // ğŸ“Œ `ãƒãƒƒã‚«ã‚½ãƒ³,ç¦å²¡å¸‚ | ãƒãƒƒã‚«ã‚½ãƒ³,ä¸­å¤®åŒº | ãƒãƒƒã‚«ã‚½ãƒ³,å¤©ç¥`
  const andGroups = areaParts.map((area) => `${data.category},${area}`)

  // ğŸ“Œ `groups` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½œæˆï¼ˆ`|` ã§çµåˆï¼‰
  return andGroups.join("|")
}
